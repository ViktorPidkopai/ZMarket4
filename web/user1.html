<!DOCTYPE html>
<html>

<head lang="en">

    <meta charset="utf-8"/>
    <title>Buy!</title>
    <script src="js/jquery-2.1.4.min.js"></script>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <script src="js/bootstrap.min.js"></script>

</head>

<body>

<script type="text/javascript">

    $(document).ready(function () {
        $.getJSON("api/pet", function (data) {
            fillTable(data);
        });
    });

    function getSearchText() {
        var searchText = document.forms["searchForm"].elements["searchInput"].value;
        if (searchText != '') {
            alert("TODO - запилить поиск по товарам");
        }
    }

    function fillTable(data) {
        var tableHead = '<thead><tr><th>' + 'id' + '</th>' +
                '<th>' + 'Name' + '</th>' +
                '<th>' + 'Price' + '</th>' +
                '<th>' + 'Actions' + '</th></tr></thead><tbody>';
        var tableBody = '';
        var inputs = '<tr><td>#</td>' +
                '<td><input type="text" class="form-control" name="name" id="name" onkeyup="validate();" required/></td>' +
                '<td><input type="number" class="form-control" name="price" id="price" step="0" onkeyup="validate();" required/></td>' +
                '<td><button type="button" class="btn btn-success" id="add_btn" disabled><span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span>&emsp;Add</button></td>' +
                '</tr></tbody>';
        $.each(data, function (index, value) {
            console.log("index = " + index);
            console.log("value = " + value);
            tableBody += '<tr><td>' + value.id + '</td>' +
                    '<td>' + value.name + '</td>' +
                    '<td>' + value.price / 100 + '</td>' +
                    '<td><button type="button" class="btn btn-primary btn-xs edit_btn" data-toggle="modal" data-target="#edit_modal" id = "' + value.id + '"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>&emsp;Edit</button>&nbsp;&nbsp;' +
                    '<button type="button" class="btn btn-danger btn-xs delete_btn" id = "' + value.id + '"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span>&emsp;Delete</button></td></tr>';
        });
        $('#itemsTable').html('');
        $('#itemsTable').append(tableHead);
        $('#itemsTable').append(tableBody);
        $('#itemsTable').append(inputs);
        console.log("fillTable() OK");
    }

</script>

<nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <a class="navbar-brand" href="https://github.com/ViktorPidkopai/ZMarket4" target="_blank">ZMarket</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#">Cart</a></li>
            </ul>
            <form class="navbar-form navbar-right" id="searchForm">
                <input class="form-control" placeholder="Search..." type="text" id="searchInput">
                <button type="submit" class="btn btn-default" id="searchBtn" onClick="getSearchText();">Go!</button>
            </form>
        </div>
    </div>
</nav>

<div class="container">
    <div class="row">
        <div class="col-md-3">
            <ul id="menu" class="nav nav-sidebar">
                <li><a href="">All</a></li>
                <li><a href="">Pets</a></li>
                <li><a href="">Feeds</a></li>
                <li><a href="">Tools</a></li>
            </ul>
        </div>
        <div class="col-md-9">
            <h3>Connecting the OpenCart administration</h3>
            <table class="table table-hover" id="itemsTable">
                <thead>
                <tr>
                    <th>#</th>
                    <th>Name</th>
                    <th>Description</th>
                    <th>Price</th>
                    <th>Actions</th>
                </tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </div>
</div>

<footer class="text-center">
    <a href="https://github.com/ViktorPidkopai" target="_blank">(C) Viktor Pidkopai 2015</a>
</footer>

</body>
</html>